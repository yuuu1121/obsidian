---
date: 2024-11-15
status: Permanent
tags:
  - Study/DL
  - Study/Lecture/Machine-Learning
aliases: 
keywords: 
related notes: 
reference: 
author: 
url: 
dg-publish: false
---
# Attention
- **Definition**  
	- 입력 데이터에서 가장 중요한 특징에 **집중**하도록 설계된 딥러닝 기법.  
	- **가장 중요한 정보**를 식별하고 이에 집중함으로써 모델의 예측 성능과 처리 효율을 향상.  
	- **작동 원리**:  
		- 주의 메커니즘은 **키(key)**, **쿼리(query)**, **값(value)** 구조를 사용하여 입력 요소 간의 중요도를 평가하고, 특정 부분에 집중하여 정보를 효율적으로 처리.  
	
	- **Applications**  
		- **이미지 처리**:  
			- 이미지 설명 생성 시, 사진의 핵심 부분(예: 건축물, 상징적 사물 등)에 집중하여 텍스트를 생성.  
			- 모델이 주목할 영역을 자동으로 선택하여 효율적이고 정확한 처리 가능.  
		
		- **자연어 처리(NLP)**:  
			- 문장에서 중요한 단어를 식별해 문맥 이해를 향상.  
			- 예: 문장에서 **'동물'**과 **'먹다'** 같은 단어가 연관된 경우, 주의 메커니즘은 해당 단어들에 높은 주의를 부여하여 더 정확한 문장 해석 가능.  

<br>

- **Principle**
	- **Key-Query-Value 구조**  
		1. **Query(질문)**, **Key(정보의 인덱스)**, **Value(실제 정보)**를 사용해 중요한 특징을 선택.  
		2. Query와 Key의 유사도를 계산하여 **주의도(attention score)**를 산출.  
		3. 주의도를 **가중치**로 활용해 중요한 Value에 더 큰 가중치를 부여하고, 이를 기반으로 출력을 생성.  
	
	- **작동 원리**  
		- **Query-Key 매칭**:  
			- Query를 기준으로 Key와의 유사도를 계산해 각 정보의 중요도를 평가.  
			- 유사도는 주로 **코사인 유사도**로 계산되며, 결과값은 **소프트맥스(softmax)** 함수로 정규화되어 주의도가 합산 1이 되도록 함.  
		- **출력 생성**:  
			- 주의도 맵(attention map)을 생성해, Value와 곱하여 중요한 정보에 가중치를 부여.  
			- 최종 출력은 입력의 중요한 부분이 강조된 새로운 정보로 전달. 
	- **주의도 맵(attention map)**  
		- 입력 요소 간의 중요도를 시각화한 결과물.  
		- 이 맵과 Value를 곱하여 중요도가 높은 정보에 가중치를 부여한 새로운 출력 생성.

	```ad-example
	title: Google 검색
	![[Pasted image 20241115085944.png]]
	
	- **Query**: 사용자가 입력하는 검색어.  
	- **Key**: 데이터베이스의 문서 제목.  
	- **Value**: 문서의 실제 내용.  
	- Google은 Query와 Key 간의 유사도를 계산해 관련된 문서를 찾고, 사용자가 선택한 문서의 내용을 Value로 제공. 
	```

<br>

## Self-attention
- **Definition**
	- 입력 데이터 내에서 각 요소가 다른 요소들과의 연관성을 스스로 평가하여, 중요한 특징에 집중할 수 있도록 하는 메커니즘
	- 입력의 각 요소가 전체 맥락을 고려하여 가장 중요한 정보에 가중치를 두고 처리

<br>

- **Principle**
	1. 입력에서 **쿼리(query)**, **키(key)**, **값(value)**를 생성
	2. 각 요소가 자신과 다른 요소 간의 **유사도**를 계산하여 가중치를 부여
	3. 중요도가 높은 요소에 더 큰 가중치를 부여하여 정보를 통합

$$AttentionLayer(Q, K, V)=SoftMax\left({Q\cdot K^\top\over scaling}\right)\cdot V$$

![[Pasted image 20241115090328.png]]

